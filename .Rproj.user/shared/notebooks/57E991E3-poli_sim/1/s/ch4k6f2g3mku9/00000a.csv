"0","model$learning_progress <- NA_real_"
"0","for (i in 1:(n+1)){"
"0",""
"0","  previous_trial_bin <- model %>% "
"0","    filter(trials == i-1) %>% "
"0","    select(bin1:bin4) %>% "
"0","    pivot_longer(bin1:bin4, names_to = ""bin"", values_to = ""prev_bin"")"
"0","  "
"0","  current_trial_bin <- model %>% "
"0","    filter(trials == i) %>% "
"0","    select(bin1:bin4) %>% "
"0","    pivot_longer(bin1:bin4, names_to = ""bin"", values_to = ""curr_bin"")"
"0","  "
"0","  trial_bin = left_join(previous_trial_bin, "
"0","            current_trial_bin, "
"0","            by = ""bin"")"
"0","  "
"0","  current_trial_prob <- model %>% "
"0","    filter(trials == i) %>% "
"0","    select(p1:p4) %>% "
"0","    rename(bin1 = p1, bin2 = p2, bin3 = p3, bin4 = p4) %>% "
"0","    pivot_longer(bin1:bin4, names_to = ""bin"", values_to = ""curr_prob"")"
"0","  "
"0","  trial_bin = left_join(trial_bin, "
"0","                        current_trial_prob, "
"0","                        by = ""bin"")"
"0","  "
"0","  d_bin = trial_bin %>% "
"0","    mutate(d_bin = curr_prob * log2(curr_bin/prev_bin)) %>% "
"0","    summarise(sum(d_bin)) %>% "
"0","    pull()"
"0",""
"0","  "
"0","  model[model$trials == i, ]$learning_progress <- d_bin"
"0","  "
"0","}"
"0",""
"0","model"
